# VesselGPT: Autoregressive Modeling of Vascular Geometry
This repository contains the official implementation of our MICCAI 2025 paper:  
**"VesselGPT: Autoregressive Modeling of Vascular Geometry"**

<p align="center">
  <img src="assets/Fig1.jpg" width="600"/>
</p>


---

## 📄 Paper

> Paula Feldman, Martin Sinnona, Viviana Siless, Claudio Delrieux, Emmanuel Iarussi
> *VesselGPT: Autoregressive Modeling of Vascular Geometry*  
> Accepted at MICCAI 2025  
> [Full Paper](https://arxiv.org/pdf/2505.13318v1)

---


## 🚀 Getting Started

Follow these steps to preprocess the data, train the model, and generate new vascular structures.

1. Prepare the Data

    -Use Preprocessing/Sections.ipynb to preprocess vascular meshes into sequences suitable for training the first stage (VQ-VAE).

    -Use sections/cutTrees to trim trees to a desired height.

    -We recommend normalizing meshes to the range [-1, 1].

    -datasets.ipynb includes utilities to:

    *Move tree roots to the origin

    *Apply data augmentation via random rotations

2. Train Stage 1 (VQ-VAE)

    -Run train-stage1.ipynb to train the first-stage VQ-VAE model.

    -Use testStage1.ipynb to evaluate its performance on the validation set.

3. Tokenize the Dataset

    -Use the trained VQ-VAE to tokenize your dataset.

    -This step is implemented in datasets.ipynb.

4. Train Stage 2 (Transformer)

    - Run train-gpt2.ipynb to train the autoregressive transformer on the tokenized data.

5. Generate Vascular Structures

    -Use test-stage2.ipynb to sample and visualize new vascular geometries generated by the model.


## 🖼️ Generated structures and comparison with state of the art methods

<p align="center"> <img src="assets/resultados.png" width="700"/> </p>

## 📝 Citation

If you find this work useful, please consider citing us:


> @article{feldman2025vesselgpt,
>  title={VesselGPT: Autoregressive Modeling of Vascular Geometry},
>  author={Feldman, Paula and Sinnona, Martin and Siless, Viviana and Delrieux, Claudio and Iarussi, Emmanuel},
>  journal={arXiv preprint arXiv:2505.13318},
>  year={2025}
>}



📬 Contact

For questions or issues, reach out to: 📧 paulafeldman@conicet.gov.ar

<p align="center"> <img src="assets/miccai2025-logo.png" alt="MICCAI 2025" width="300"/> </p> 